<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h1>Tendencia Mensual de Gastos</h1>
<canvas id="graficaMensual"></canvas>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="js/supabase.js"></script>

<script>
async function cargarGrafica() {
  const { data } = await supabase
    .from('gastos')
    .select('total, created_at');

  const meses = {};
  data.forEach(g => {
    const mes = new Date(g.created_at)
      .toLocaleString('es-MX', { month: 'short', year: 'numeric' });
    meses[mes] = (meses[mes] || 0) + Number(g.total);
  });

  new Chart(graficaMensual, {
    type: 'line',
    data: {
      labels: Object.keys(meses),
      datasets: [{
        label: 'Gasto mensual',
        data: Object.values(meses)
      }]
    }
  });
}

cargarGrafica();
</script>

</body>
</html>
